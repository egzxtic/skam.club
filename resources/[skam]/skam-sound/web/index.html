<html>
    <head>
        <script src="nui://game/ui/jquery.js" type="text/javascript"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/howler/2.1.1/howler.min.js" type="text/javascript"></script>
        <script>
            var audioPlayer = null;
            window.addEventListener('message', function(event) {
                if (event.data.transactionType == "playSound") {
                    const allowedPattern = /^[a-zA-Z0-9_\-]+$/;
                    if(!allowedPattern.test(event.data.transactionFile)) return;
                    
                    let volume = Number(event.data.transactionVolume);
                    if (isNaN(volume)) volume = 1.0;
                    volume = Math.max(0, Math.min(1, volume));

                    if (audioPlayer != null) {
                        audioPlayer.unload();
                    }

                    audioPlayer = new Howl({
                        src: ["./sounds/" + event.data.transactionFile + ".ogg"],
                        volume: volume,
                        onloaderror: function() {
                            console.error("Błąd ładowania dźwięku:", event.data.transactionFile);
                        }
                    });
                    audioPlayer.play();
                }
            });
        </script>
    </head>
    <body>
    </body>
</html>